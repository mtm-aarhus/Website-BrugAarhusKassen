{% extends "udeservering.html" %}

{% block content %}
<h4 class="mb-3">Fakturer ikke</h4>

<div id="toolbar" class="d-flex gap-2">
    <button id="btnBulkOpretIgen" class="btn btn-primary btn-sm">
        Opret igen
    </button>
</div>

<div class="table-responsive">
  <table id="fakturer-ikke-table"
    class="table table-striped table-bordered align-middle"
    data-toggle="table"
    data-toolbar="#toolbar"
    data-pagination="true"
    data-side-pagination="server"
    data-search="true"
    data-sort-name="DeskproID"
    data-sort-order="desc"
    data-url="{{ url_for('udeservering.api_fakturering') }}?status=FakturerIkke"
    data-page-size="25"
    data-unique-id="FakturaLinjeID"
    data-total-field="total"
    data-data-field="rows">
    <thead>
      <tr>
        <th data-field="state" data-checkbox="true"></th>
        <th data-field="DeskproID" data-formatter="linkFormatter" data-sortable="true">Sag</th>
        <th data-field="Firmanavn" data-sortable="true">Firma</th>
        <th data-field="Adresse" data-sortable="true">Adresse</th>
        <th data-field="FakturaDatoSort" data-sortable="true" data-formatter="dateFormatter">Fakturadato</th>
        <th data-field="Serveringsareal" data-sortable="true">Areal</th>
        <th data-field="Facadelaengde" data-sortable="true">Facade</th>
      </tr>
    </thead>
  </table>
</div>
{% endblock %}
{% block extra_js %}
{{ super() }}
<script>
document.getElementById("btnBulkOpretIgen").addEventListener("click", () => {
    const ids = getSelectedIdsGeneric("#fakturer-ikke-table");
    if (ids.length === 0) return alert("Vælg mindst én linje.");

    if (!confirm("Slet disse linjer og genskab dem ved næste synkronisering?")) return;

    bulkDelete(ids, () => {
        $("#fakturer-ikke-table").bootstrapTable("refresh");
    });
});
</script>
{% endblock %}
